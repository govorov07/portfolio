<!DOCTYPE html>
<html lang="ru">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<title>Спецификация. Фильтрация событий</title>
	<meta name="description" content="Спецификация. Фильтрация событий">
	<meta name="keywords" content="specification, events, filters">
	<meta name="author" content="Govorov Andrew">

	<script src="/assets/scripts/config.js"></script>

	<link rel="stylesheet" href="/assets/styles/styles.css">
	<link rel="stylesheet" href="/assets/styles/prism.css">
</head>

<body>
	<!-- Кнопка и оверлей для мобилок загрузится автоматически из sidebar.html через load-sidebar.html -->
	<div class="container" id="container">
		<!-- Сайдбар загрузится автоматически из sidebar.html через load-sidebar.html -->
		<!-- Основной контент -->
		<main class="main-content" id="main-content">
			<!-- Кнопка сворачивания сайдбара загрузится автоматически из sidebar.html через load-sidebar.html -->

			<h1 id="section-1">Спецификация. Фильтрация событий</h1>
			<!-- Оглавление статьи -->
			<nav class="article-toc" id="articleToc">
				<div class="toc-header">На этой странице</div>
				<ul class="toc-list" id="toc">
					<!-- Оглавление генерируется автоматически -->
				</ul>
			</nav>

			<!-- Контент статьи -->
			<article class="content">
				<!------------------------------------------------------------------------------------>
				<!--	История изменений															-->
				<!------------------------------------------------------------------------------------>
				<h1 id="section-2">История изменений</h1>
				<div>
					<!-- Таблица истории изменений -->
					<table class="confluence-table">
						<caption>История изменений спецификации</caption>
						<thead>
							<tr>
								<th>Версия</th>
								<th>Автор</th>
								<th>Дата изменений</th>
								<th>Описание изменений</th>
								<th>Ссылка на задачу</th>
								<th>Комментарий</th>
								<th>Источник требования</th>
								<th>Согласовано с архитектором</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>v.1.0</td>
								<td><a href="/pages/govorov/about.html">Говоров Андрей</a></td>
								<td>01.06.2025</td>
								<td>
									<p>Исходная страница.</p>
									<p>Редизайн. Добавление фильтров.</p>
								</td>
								<td><a href="https://www.atlassian.com/software/jira">B2C-28132</a></td>
								<td></td>
								<td><a href="/pages/portofolio/requirements/rfilters.html">Требования к фильтрации событий</a></td>
								<td>
									<p><a href="https://www.atlassian.com/ru/software/confluence">Системный архитектор</a></p>
									<p><span class="status-chip status-approved">СОГЛАСОВАНО</span></p>
								</td>
							</tr>
							<tr>
								<td>v.2.0</td>
								<td><a href="/pages/govorov/about.html">Говоров Андрей</a></td>
								<td>01.07.2025</td>
								<td>
									<p>Добавил сценарий загрузки раздела, функциональные и нефункциональные требования</p>
								</td>
								<td><a href="https://www.atlassian.com/software/jira">B2C-28133</a></td>
								<td></td>
								<td></td>
								<td>
									<p><a href="https://www.atlassian.com/ru/software/confluence">Системный архитектор</a></p>
									<p><span class="status-chip status-pending">НА СОГЛАСОВАНИИ</span></p>
								</td>
							</tr>
						</tbody>
					</table>
				</div>

				<!------------------------------------------------------------------------------------>
				<!--	Сценарии																	-->
				<!------------------------------------------------------------------------------------>
				<h1 id="section-3">Сценарии</h1>
				<div>
					<!-------------------------------------------------------------------------------->
					<!--	Открытие страницы "События"												-->
					<!-------------------------------------------------------------------------------->
					<h2 id="section-4">Открытие страницы "События"</h2>
					<div>
						<!---------------------------------------------------------------------------->
						<!--	USE CASE															-->
						<!---------------------------------------------------------------------------->
						<h3 id="section-5">USE CASE</h3>
						<!-- Таблица Use Case -->
						<div class="use-case-container">
							<div class="use-case-header">
								<h3>USE CASE: UC.EVENTS.LK-1</h3>
								<p class="use-case-description">Пользователь переходит в раздел "События"</p>
							</div>

							<table class="use-case-table">
								<tbody>
									<tr>
										<th width="200">Основные действующие лица:</th>
										<td>
											<ul>
												<li>Пользователь УД,</li>
												<li>ЛК/МП УД,</li>
												<li>Бэкенд УД</li>
											</ul>
										</td>
									</tr>
									<tr>
										<th>Предварительные условия:</th>
										<td>
											<ul>
												<li>Пользователь авторизован в УД,</li>
												<li>Пользователю назначена роль "Owner", "Adult" или "Child"</li>
											</ul>
										</td>
									</tr>
								</tbody>
							</table>

							<h4 class="scenario-title">Основной сценарий:</h4>
							<table class="scenario-table">
								<thead>
									<tr>
										<th width="60">Шаг</th>
										<th>Действие</th>
										<th width="120">Актор</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td>1</td>
										<td>Пользователь открывает страницу «События» (ЛК УД) / экран «События» (МП УД)</td>
										<td>Пользователь УД</td>
									</tr>
									<tr>
										<td>2</td>
										<td>ЛК/МП УД отображает страницу «События» / экран «События» с предзагруженными неактивными фильтрами и лоадером</td>
										<td>ЛК/МП УД</td>
									</tr>
									<tr>
										<td>3</td>
										<td>ЛК/МП УД вызывает метод Бэкенда УД GET api/v3/events/filters для получения типов фильтров событий</td>
										<td>ЛК/МП УД</td>
									</tr>
									<tr>
										<td>4</td>
										<td>Бэкенд УД формирует ответ на основании данных в БД events_groups и event_types</td>
										<td>Бэкенд УД</td>
									</tr>
									<tr>
										<td>5</td>
										<td>Бэкенд УД возвращает ЛК/МП УД ответ со списком типов фильтров</td>
										<td>Бэкенд УД</td>
									</tr>
									<tr>
										<td>6</td>
										<td>ЛК/МП УД отображает активные фильтры</td>
										<td>ЛК/МП УД</td>
									</tr>
									<tr>
										<td>7</td>
										<td>ЛК/МП УД вызывает метод Бэкенда УД POST api/v3/events для получения списка событий, подходящих под установленные по умолчанию фильтры</td>
										<td>ЛК/МП УД</td>
									</tr>
									<tr>
										<td>8</td>
										<td>Бэкенд УД формирует параметры запроса в EStore по переданным значениям фильтров</td>
										<td>Бэкенд УД</td>
									</tr>
									<tr>
										<td>9</td>
										<td>Бэкенд УД вызывает метод EStore POST /api/estore/events/by_devices для получения списка событий</td>
										<td>Бэкенд УД</td>
									</tr>
									<tr>
										<td>10</td>
										<td>EStore возвращает Бэкенду УД ответ со списком событий</td>
										<td>EStore</td>
									</tr>
									<tr>
										<td>11</td>
										<td>Бэкенд УД обогащает события данными</td>
										<td>Бэкенд УД</td>
									</tr>
									<tr>
										<td>12</td>
										<td>Бэкенд УД возвращает ЛК/МП УД ответ со списком событий, подходящих под установленные по умолчанию фильтры</td>
										<td>Бэкенд УД</td>
									</tr>
									<tr>
										<td>13</td>
										<td>ЛК/МП УД отображает список событий</td>
										<td>ЛК/МП УД</td>
									</tr>
								</tbody>
							</table>

							<h4 class="scenario-title">Расширения:</h4>
							
							<div class="extension-group">
								<div class="extension-header">
									<span class="extension-step">5а</span>
									<span class="extension-condition">Если Бэкенд УД по таймауту не возвращает ЛК/МП УД ответ:</span>
								</div>
								<div class="extension-content">
									<div class="platform-variant">
										<strong>ЛК УД:</strong> отображает ошибку в виде нотификации:
										<ul>
											<li>Заголовок: "Что-то пошло не так"</li>
											<li>Текст: "Не удалось загрузить список фильтров"</li>
										</ul>
									</div>
									<div class="platform-variant">
										<strong>МП УД:</strong> отображает ошибку в виде шторки:
										<ul>
											<li>Заголовок: "Что-то пошло не так"</li>
											<li>Текст: "Не удалось загрузить список фильтров"</li>
											<li>Кнопка: "Попробовать ещё раз" (перезапускает процесс с 3 шага)</li>
										</ul>
									</div>
								</div>
							</div>

							<div class="extension-group">
								<div class="extension-header">
									<span class="extension-step">5б</span>
									<span class="extension-condition">Если Бэкенд УД возвращает ЛК/МП УД ответ с ошибкой:</span>
								</div>
								<div class="extension-content">
									<div class="platform-variant">
										<strong>ЛК УД:</strong> отображает ошибку в виде нотификации:
										<ul>
											<li>Заголовок: "Что-то пошло не так"</li>
											<li>Текст: "Не удалось загрузить список фильтров"</li>
										</ul>
									</div>
									<div class="platform-variant">
										<strong>МП УД:</strong> отображает ошибку в виде шторки:
										<ul>
											<li>Заголовок: "Что-то пошло не так"</li>
											<li>Текст: "Не удалось загрузить список фильтров"</li>
											<li>Кнопка: "Попробовать ещё раз" (перезапускает процесс с 3 шага)</li>
										</ul>
									</div>
								</div>
							</div>

							<div class="extension-group">
								<div class="extension-header">
									<span class="extension-step">12а</span>
									<span class="extension-condition">Если Бэкенд УД по таймауту не возвращает ЛК/МП УД ответ:</span>
								</div>
								<div class="extension-content">
									<div class="platform-variant">
										<strong>ЛК УД:</strong> отображает ошибку в виде нотификации:
										<ul>
											<li>Заголовок: "Что-то пошло не так"</li>
											<li>Текст: "Не удалось загрузить список событий"</li>
										</ul>
									</div>
									<div class="platform-variant">
										<strong>МП УД:</strong> отображает ошибку в виде шторки:
										<ul>
											<li>Заголовок: "Что-то пошло не так"</li>
											<li>Текст: "Не удалось загрузить список событий"</li>
											<li>Кнопка: "Попробовать ещё раз" (перезапускает процесс с 7 шага)</li>
										</ul>
									</div>
								</div>
							</div>

							<div class="extension-group">
								<div class="extension-header">
									<span class="extension-step">12б</span>
									<span class="extension-condition">Если Бэкенд УД возвращает ЛК/МП УД ответ с ошибкой:</span>
								</div>
								<div class="extension-content">
									<div class="platform-variant">
										<strong>ЛК УД:</strong> отображает ошибку в виде нотификации:
										<ul>
											<li>Заголовок: "Что-то пошло не так"</li>
											<li>Текст: "{message}"</li>
										</ul>
									</div>
									<div class="platform-variant">
										<strong>МП УД:</strong> отображает ошибку в виде шторки:
										<ul>
											<li>Заголовок: "Что-то пошло не так"</li>
											<li>Текст: "{message}"</li>
											<li>Кнопка: "Попробовать ещё раз" (перезапускает процесс с 7 шага)</li>
										</ul>
									</div>
								</div>
							</div>

							<div class="extension-group">
								<div class="extension-header">
									<span class="extension-step">12в</span>
									<span class="extension-condition">Если Бэкенд УД вернул ЛК/МП УД пустой список (для установленных по умолчанию фильтров нет событий), ЛК/МП УД отображает текст «Нет событий».</span>
								</div>
							</div>
						</div>

						<!---------------------------------------------------------------------------->
						<!--	Схема открытия страницы "События"									-->
						<!---------------------------------------------------------------------------->
						<h3 id="section-6">Схема открытия страницы "События"</h3>
						<!-- Контейнер для UML диаграммы -->
						<div class="uml-container">
							<div class="uml-header">
								<h3>Диаграмма последовательности: Загрузка раздела событий</h3>
								<p class="uml-description">Визуализация взаимодействия компонентов при загрузке раздела событий</p>
							</div>
					
							<div class="uml-diagram">
								<svg class="uml-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1030" preserveAspectRatio="xMidYMid meet" version="1.1" viewBox="0 0 977 1030" width="100%">
									<defs/>
									<g>
										<g>
											<title>.......... ..........</title>
											<rect fill="#FFFFFF" height="827.8047" style="stroke:#181818;stroke-width:1;" width="10" x="337.7329" y="112.4297" />
										</g>
										<g>
											<title>...... ..</title>
											<rect fill="#FFFFFF" height="286.9375" style="stroke:#181818;stroke-width:1;" width="10" x="577.144" y="185.8281" />
										</g>
										<g>
											<title>...... ..</title>
											<rect fill="#FFFFFF" height="357.0703" style="stroke:#181818;stroke-width:1;" width="10" x="577.144" y="538.0313" />
										</g>
										<g>
											<title>EStore</title>
											<rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="925.5063" y="633.4297" />
										</g>
										<rect fill="none" height="309.0703" style="stroke:#000000;stroke-width:1.5;" width="864.8247" x="10" y="200.8281" />
										<rect fill="none" height="379.2031" style="stroke:#000000;stroke-width:1.5;" width="960.5845" x="10" y="553.0313" />
										<g>
											<title>............ ..</title>
											<rect fill="#000000" fill-opacity="0.00000" height="867.9375" width="8" x="82.5093" y="81.2969" />
											<line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="86" x2="86" y1="81.2969" y2="949.2344" />
										</g>
										<g>
											<title>.......... ..........</title>
											<rect fill="#000000" fill-opacity="0.00000" height="867.9375" width="8" x="338.7329" y="81.2969" />
											<line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="342.5161" x2="342.5161" y1="81.2969" y2="949.2344" />
										</g>
										<g>
											<title>...... ..</title>
											<rect fill="#000000" fill-opacity="0.00000" height="867.9375" width="8" x="578.144" y="81.2969" />
											<line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="581.5894" x2="581.5894" y1="81.2969" y2="949.2344" />
										</g>
										<g>
											<title>EStore</title>
											<rect fill="#000000" fill-opacity="0.00000" height="867.9375" width="8" x="926.5063" y="81.2969" />
											<line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="930.4282" x2="930.4282" y1="81.2969" y2="949.2344" />
										</g>
										<g class="participant participant-head" data-participant="u">
											<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127.0186" x="20" y="77.9951">Пользователь УД</text>
											<ellipse cx="86.5093" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;" />
											<path d="M86.5093,21.5 L86.5093,48.5 M73.5093,29.5 L99.5093,29.5 M86.5093,48.5 L73.5093,63.5 M86.5093,48.5 L99.5093,63.5" fill="none" style="stroke:#181818;stroke-width:0.5;" />
										</g>
										<g class="participant participant-tail" data-participant="u">
											<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127.0186" x="20" y="961.2295">Пользователь УД</text>
											<ellipse cx="86.5093" cy="973.0313" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;" />
											<path d="M86.5093,981.0313 L86.5093,1008.0313 M73.5093,989.0313 L99.5093,989.0313 M86.5093,1008.0313 L73.5093,1023.0313 M86.5093,1008.0313 L99.5093,1023.0313" fill="none" style="stroke:#181818;stroke-width:0.5;" />
										</g>
										<g class="participant participant-head" data-participant="f">
											<rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="198.4336" x="243.5161" y="50" />
											<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="184.4336" x="250.5161" y="69.9951">Клиентское приложение</text>
										</g>
										<g class="participant participant-tail" data-participant="f">
											<rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="198.4336" x="243.5161" y="948.2344" />
											<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="184.4336" x="250.5161" y="968.2295">Клиентское приложение</text>
										</g>
										<g class="participant participant-head" data-participant="b">
											<rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91.1094" x="536.5894" y="50" />
											<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77.1094" x="543.5894" y="69.9951">Бэкенд УД</text>
										</g>
										<g class="participant participant-tail" data-participant="b">
											<rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91.1094" x="536.5894" y="948.2344" />
											<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77.1094" x="543.5894" y="968.2295">Бэкенд УД</text>
										</g>
										<g class="participant participant-head" data-participant="e">
											<rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60.1563" x="900.4282" y="50" />
											<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.1563" x="907.4282" y="69.9951">EStore</text>
										</g>
										<g class="participant participant-tail" data-participant="e">
											<rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60.1563" x="900.4282" y="948.2344" />
											<text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46.1563" x="907.4282" y="968.2295">EStore</text>
										</g>
										<g>
											<title>.......... ..........</title>
											<rect fill="#FFFFFF" height="827.8047" style="stroke:#181818;stroke-width:1;" width="10" x="337.7329" y="112.4297" />
										</g>
										<g>
											<title>...... ..</title>
											<rect fill="#FFFFFF" height="286.9375" style="stroke:#181818;stroke-width:1;" width="10" x="577.144" y="185.8281" />
										</g>
										<g>
											<title>...... ..</title>
											<rect fill="#FFFFFF" height="357.0703" style="stroke:#181818;stroke-width:1;" width="10" x="577.144" y="538.0313" />
										</g>
										<g>
											<title>EStore</title>
											<rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="925.5063" y="633.4297" />
										</g>
										<g class="message" data-participant-1="u" data-participant-2="f">
											<polygon fill="#181818" points="325.7329,108.4297,335.7329,112.4297,325.7329,116.4297,329.7329,112.4297" style="stroke:#181818;stroke-width:1;" />
											<line style="stroke:#181818;stroke-width:1;" x1="86.5093" x2="331.7329" y1="112.4297" y2="112.4297" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="93.5093" y="107.3638">1</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219.1782" x="106.5547" y="107.3638">Открывает страницу "События"</text>
										</g>
										<g class="message" data-participant-1="f" data-participant-2="u">
											<polygon fill="#181818" points="97.5093,152.6953,87.5093,156.6953,97.5093,160.6953,93.5093,156.6953" style="stroke:#181818;stroke-width:1;" />
											<line style="stroke:#181818;stroke-width:1;" x1="91.5093" x2="336.7329" y1="156.6953" y2="156.6953" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="103.5093" y="144.063">2</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.8037" x="116.5547" y="136.4966">Отображает страницу</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.7666" x="116.5547" y="151.6294">с заполнителями и лоадером</text>
										</g>
										<g class="message" data-participant-1="f" data-participant-2="b">
											<polygon fill="#181818" points="565.144,181.8281,575.144,185.8281,565.144,189.8281,569.144,185.8281" style="stroke:#181818;stroke-width:1;" />
											<line style="stroke:#181818;stroke-width:1;" x1="347.7329" x2="571.144" y1="185.8281" y2="185.8281" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="354.7329" y="180.7622">3</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.1069" x="367.7783" y="180.7622">GET api/v3/events/filters</text>
										</g>
										<path d="M10,200.8281 L74.4429,200.8281 L74.4429,207.9609 L64.4429,217.9609 L10,217.9609 L10,200.8281" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" />
										<rect fill="none" height="309.0703" style="stroke:#000000;stroke-width:1.5;" width="864.8247" x="10" y="200.8281" />
										<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="213.895">alt</text>
										<text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="47.2119" x="89.4429" y="213.0386">[Успех]</text>
										<g class="message" data-participant-1="b" data-participant-2="b">
											<line style="stroke:#181818;stroke-width:1;" x1="587.144" x2="629.144" y1="254.2266" y2="254.2266" />
											<line style="stroke:#181818;stroke-width:1;" x1="629.144" x2="629.144" y1="254.2266" y2="267.2266" />
											<line style="stroke:#181818;stroke-width:1;" x1="588.144" x2="629.144" y1="267.2266" y2="267.2266" />
											<polygon fill="#181818" points="598.144,263.2266,588.144,267.2266,598.144,271.2266,594.144,267.2266" style="stroke:#181818;stroke-width:1;" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="594.144" y="241.5942">4</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241.5029" x="607.1895" y="234.0278">Формирует ответ по данным из БД</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.3096" x="607.1895" y="249.1606">(events_groups и event_types)</text>
										</g>
										<g class="message" data-participant-1="b" data-participant-2="f">
											<polygon fill="#181818" points="358.7329,292.3594,348.7329,296.3594,358.7329,300.3594,354.7329,296.3594" style="stroke:#181818;stroke-width:1;" />
											<line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="352.7329" x2="576.144" y1="296.3594" y2="296.3594" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="364.7329" y="291.2935">5</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.3657" x="377.7783" y="291.2935">Ответ со списком фильтров</text>
										</g>
										<g class="message" data-participant-1="f" data-participant-2="u">
											<polygon fill="#181818" points="97.5093,336.625,87.5093,340.625,97.5093,344.625,93.5093,340.625" style="stroke:#181818;stroke-width:1;" />
											<line style="stroke:#181818;stroke-width:1;" x1="91.5093" x2="336.7329" y1="340.625" y2="340.625" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="103.5093" y="327.9927">6</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.4238" x="116.5547" y="320.4263">Отображает список</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.0649" x="116.5547" y="335.5591">активных фильтров</text>
										</g>
										<line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="874.8247" y1="349.625" y2="349.625" />
										<text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="142.8174" x="15" y="359.8354">[Ошибка по таймауту]</text>
										<g class="message" data-participant-1="b" data-participant-2="f">
											<polygon fill="#181818" points="358.7329,395.6953,348.7329,399.6953,358.7329,403.6953,354.7329,399.6953" style="stroke:#181818;stroke-width:1;" />
											<line style="stroke:#181818;stroke-width:2;" x1="559.144" x2="569.144" y1="394.6953" y2="404.6953" />
											<line style="stroke:#181818;stroke-width:2;" x1="559.144" x2="569.144" y1="404.6953" y2="394.6953" />
											<line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="352.7329" x2="564.144" y1="399.6953" y2="399.6953" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="38.7461" x="364.7329" y="387.063">[5а1]</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.9692" x="407.479" y="379.4966">Превышено время</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.6943" x="407.479" y="394.6294">ожидания ответа</text>
										</g>
										<g class="message" data-participant-1="f" data-participant-2="u">
											<polygon fill="#181818" points="97.5093,424.8281,87.5093,428.8281,97.5093,432.8281,93.5093,428.8281" style="stroke:#181818;stroke-width:1;" />
											<line style="stroke:#181818;stroke-width:1;" x1="91.5093" x2="336.7329" y1="428.8281" y2="428.8281" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="38.7461" x="103.5093" y="423.7622">[5а2]</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.2354" x="146.2554" y="423.7622">Отображает ошибку</text>
										</g>
										<line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="874.8247" y1="437.8281" y2="437.8281" />
										<text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="182.2144" x="15" y="448.0386">[Ошибка запроса фильтров]</text>
										<g class="message" data-participant-1="b" data-participant-2="f">
											<polygon fill="#181818" points="358.7329,468.7656,348.7329,472.7656,358.7329,476.7656,354.7329,472.7656" style="stroke:#181818;stroke-width:1;" />
											<line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="352.7329" x2="581.144" y1="472.7656" y2="472.7656" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.0508" x="364.7329" y="467.6997">[5б1]</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.019" x="407.7837" y="467.6997">Ответ с ошибкой</text>
										</g>
										<g class="message" data-participant-1="f" data-participant-2="u">
											<polygon fill="#181818" points="97.5093,497.8984,87.5093,501.8984,97.5093,505.8984,93.5093,501.8984" style="stroke:#181818;stroke-width:1;" />
											<line style="stroke:#181818;stroke-width:1;" x1="91.5093" x2="336.7329" y1="501.8984" y2="501.8984" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.0508" x="103.5093" y="496.8325">[5б2]</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.2354" x="146.5601" y="496.8325">Отображает ошибку</text>
										</g>
										<g class="message" data-participant-1="f" data-participant-2="b">
											<polygon fill="#181818" points="565.144,534.0313,575.144,538.0313,565.144,542.0313,569.144,538.0313" style="stroke:#181818;stroke-width:1;" />
											<line style="stroke:#181818;stroke-width:1;" x1="347.7329" x2="571.144" y1="538.0313" y2="538.0313" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="354.7329" y="532.9653">7</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.75" x="367.7783" y="532.9653">POST api/v3/events</text>
										</g>
										<path d="M10,553.0313 L74.4429,553.0313 L74.4429,560.1641 L64.4429,570.1641 L10,570.1641 L10,553.0313" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" />
										<rect fill="none" height="379.2031" style="stroke:#000000;stroke-width:1.5;" width="960.5845" x="10" y="553.0313" />
										<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="566.0981">alt</text>
										<text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="47.2119" x="89.4429" y="565.2417">[Успех]</text>
										<g class="message" data-participant-1="b" data-participant-2="b">
											<line style="stroke:#181818;stroke-width:1;" x1="587.144" x2="629.144" y1="591.2969" y2="591.2969" />
											<line style="stroke:#181818;stroke-width:1;" x1="629.144" x2="629.144" y1="591.2969" y2="604.2969" />
											<line style="stroke:#181818;stroke-width:1;" x1="588.144" x2="629.144" y1="604.2969" y2="604.2969" />
											<polygon fill="#181818" points="598.144,600.2969,588.144,604.2969,598.144,608.2969,594.144,604.2969" style="stroke:#181818;stroke-width:1;" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="594.144" y="586.231">8</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.7417" x="607.1895" y="586.231">формирует запрос в EStore</text>
										</g>
										<g class="message" data-participant-1="b" data-participant-2="e">
											<polygon fill="#181818" points="913.5063,629.4297,923.5063,633.4297,913.5063,637.4297,917.5063,633.4297" style="stroke:#181818;stroke-width:1;" />
											<line style="stroke:#181818;stroke-width:1;" x1="587.144" x2="919.5063" y1="633.4297" y2="633.4297" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="594.144" y="628.3638">9</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228.249" x="607.1895" y="628.3638">POST api/estore/events/by_devices</text>
										</g>
										<g class="message" data-participant-1="e" data-participant-2="b">
											<polygon fill="#181818" points="598.144,658.5625,588.144,662.5625,598.144,666.5625,594.144,662.5625" style="stroke:#181818;stroke-width:1;" />
											<line style="stroke:#181818;stroke-width:1;" x1="592.144" x2="929.5063" y1="662.5625" y2="662.5625" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="604.144" y="657.4966">10</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.2441" x="626.2349" y="657.4966">Ответ со списком событий</text>
										</g>
										<g class="message" data-participant-1="b" data-participant-2="b">
											<line style="stroke:#181818;stroke-width:1;" x1="587.144" x2="629.144" y1="691.6953" y2="691.6953" />
											<line style="stroke:#181818;stroke-width:1;" x1="629.144" x2="629.144" y1="691.6953" y2="704.6953" />
											<line style="stroke:#181818;stroke-width:1;" x1="588.144" x2="629.144" y1="704.6953" y2="704.6953" />
											<polygon fill="#181818" points="598.144,700.6953,588.144,704.6953,598.144,708.6953,594.144,704.6953" style="stroke:#181818;stroke-width:1;" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="594.144" y="686.6294">11</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292.2715" x="616.2349" y="686.6294">Обогащает полученные события данными</text>
										</g>
										<g class="message" data-participant-1="b" data-participant-2="f">
											<polygon fill="#181818" points="358.7329,729.8281,348.7329,733.8281,358.7329,737.8281,354.7329,733.8281" style="stroke:#181818;stroke-width:1;" />
											<line style="stroke:#181818;stroke-width:1;" x1="352.7329" x2="576.144" y1="733.8281" y2="733.8281" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="364.7329" y="728.7622">12</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.2441" x="386.8237" y="728.7622">Ответ со списком событий</text>
										</g>
										<g class="message" data-participant-1="f" data-participant-2="u">
											<polygon fill="#181818" points="97.5093,758.9609,87.5093,762.9609,97.5093,766.9609,93.5093,762.9609" style="stroke:#181818;stroke-width:1;" />
											<line style="stroke:#181818;stroke-width:1;" x1="91.5093" x2="336.7329" y1="762.9609" y2="762.9609" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="103.5093" y="757.895">13</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.4087" x="125.6001" y="757.895">Отображает список событий</text>
										</g>
										<line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="970.5845" y1="771.9609" y2="771.9609" />
										<text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="142.8174" x="15" y="782.1714">[Ошибка по таймауту]</text>
										<g class="message" data-participant-1="b" data-participant-2="f">
											<polygon fill="#181818" points="358.7329,818.0313,348.7329,822.0313,358.7329,826.0313,354.7329,822.0313" style="stroke:#181818;stroke-width:1;" />
											<line style="stroke:#181818;stroke-width:2;" x1="559.144" x2="569.144" y1="817.0313" y2="827.0313" />
											<line style="stroke:#181818;stroke-width:2;" x1="559.144" x2="569.144" y1="827.0313" y2="817.0313" />
											<line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="352.7329" x2="564.144" y1="822.0313" y2="822.0313" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47.7915" x="364.7329" y="809.3989">[11а1]</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.9692" x="416.5244" y="801.8325">Превышено время</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.6943" x="416.5244" y="816.9653">ожидания ответа</text>
										</g>
										<g class="message" data-participant-1="f" data-participant-2="u">
											<polygon fill="#181818" points="97.5093,847.1641,87.5093,851.1641,97.5093,855.1641,93.5093,851.1641" style="stroke:#181818;stroke-width:1;" />
											<line style="stroke:#181818;stroke-width:1;" x1="91.5093" x2="336.7329" y1="851.1641" y2="851.1641" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47.7915" x="103.5093" y="846.0981">[11а2]</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.2354" x="155.3008" y="846.0981">Отображает ошибку</text>
										</g>
										<line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="970.5845" y1="860.1641" y2="860.1641" />
										<text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="173.3091" x="15" y="870.3745">[Ошибка запроса событий]</text>
										<g class="message" data-participant-1="b" data-participant-2="f">
											<polygon fill="#181818" points="358.7329,891.1016,348.7329,895.1016,358.7329,899.1016,354.7329,895.1016" style="stroke:#181818;stroke-width:1;" />
											<line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="352.7329" x2="581.144" y1="895.1016" y2="895.1016" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48.0962" x="364.7329" y="890.0356">[11б1]</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.019" x="416.8291" y="890.0356">Ответ с ошибкой</text>
										</g>
										<g class="message" data-participant-1="f" data-participant-2="u">
											<polygon fill="#181818" points="97.5093,920.2344,87.5093,924.2344,97.5093,928.2344,93.5093,924.2344" style="stroke:#181818;stroke-width:1;" />
											<line style="stroke:#181818;stroke-width:1;" x1="91.5093" x2="336.7329" y1="924.2344" y2="924.2344" />
											<text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="48.0962" x="103.5093" y="919.1685">[11б2]</text>
											<text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.2354" x="155.6055" y="919.1685">Отображает ошибку</text>
										</g>
									</g>
								</svg>
							</div>
							
							<div class="uml-legend">
								<h4>Условные обозначения:</h4>
								<div class="legend-items">
									<div class="legend-item">
										<div class="legend-color success"></div>
										<span>Основной сценарий (успех)</span>
									</div>
									<div class="legend-item">
										<div class="legend-color error"></div>
										<span>Альтернативный сценарий (ошибка)</span>
									</div>
									<div class="legend-item">
										<div class="legend-color timeout"></div>
										<span>Таймаут запроса</span>
									</div>
								</div>
							</div>
						</div>
						
						<!-- Блок кода PlantUML -->
						<div class="code-container">
							<div class="code-header">
								<span class="code-title">Диаграмма последовательности: Загрузка событий</span>
								<div class="code-language">PlantUML</div>
							</div>
							<div>
								<pre><code class="language-plantuml">
									@startuml
									skinparam responseMessageBelowArrow true
									'skinparam sequenceMessageAlign direction
									autonumber

									actor "Пользователь УД" as u
									participant "Клиентское приложение" as f
									participant "Бэкенд УД" as b
									'database "База данных УД" as db
									participant EStore as e

									u -> f: Открывает страницу "События"
									activate f
									f -> u: Отображает страницу \nс заполнителями и лоадером 
									f -> b: GET api/v3/events/filters
									activate b

									alt Успех
										b -> b: Формирует ответ по данным из БД \n(events_groups и event_types)
										b --> f: Ответ со списком фильтров
										f -> u: Отображает список \nактивных фильтров
									else Ошибка по таймауту
										autonumber stop
										autonumber "&lt;b>[5а0]"
										b x-- f: Превышено время \nожидания ответа
										f -> u: Отображает ошибку
										autonumber stop
									else Ошибка запроса фильтров
										autonumber stop
										autonumber "&lt;b>[5б0]"
										b --> f: Ответ с ошибкой
										deactivate b
										f -> u: Отображает ошибку
										autonumber stop
									end

									autonumber 7
									f -> b: POST api/v3/events
									activate b

									alt Успех
										b -> b: формирует запрос в EStore
										b -> e: POST api/estore/events/by_devices
										activate e
										e -> b: Ответ со списком событий
										deactivate e
										b -> b: Обогащает полученные события данными
										b -> f: Ответ со списком событий
										f -> u: Отображает список событий
									else Ошибка по таймауту
										autonumber stop
										autonumber "&lt;b>[11а0]"
										b x-- f: Превышено время \nожидания ответа
										f -> u: Отображает ошибку
										autonumber stop
									else Ошибка запроса событий
										autonumber stop
										autonumber "&lt;b>[11б0]"
										b --> f: Ответ с ошибкой
										deactivate b
										f -> u: Отображает ошибку
										autonumber stop
									end
									@enduml
								</code></pre>
							</div>
						</div>
					</div>
				</div>

				<!------------------------------------------------------------------------------------>
				<!--	Функциональные требования													-->
				<!------------------------------------------------------------------------------------>
				<h1 id="section-7">Функциональные требования</h1>
				<div>
					<ol>
						<li>Критические события (метод <a href="/pages/portofolio/api/postevents.html">POST api/v3/events</a>, параметр <strong>events.level = critical</strong>) должны подсвечиваться красной точкой рядом с текстом события.</li>
						<li>Если по установленным фильтрам у пользователя нет событий, должен отображаться текст «Нет событий».</li>
						<li>Настройки фильтров по умолчанию:
							<ol>
								<li>Дата события: текущие сутки;</li>
								<li>Время события: 00:00 — 23:59;</li>
								<li>Вид событий: Все виды событий;</li>
								<li>Устройства: Все устройства;</li>
								<li>Тип событий: Все типы событий.</li>
							</ol>
						</li>
						<li>Дата: при нажатии должен открываться календарь, где можно:
							<ol>
								<li>выбрать дату, по умолчанию стоит текущая дата;</li>
								<li>выбрать месяц (кнопки переключения вперед/назад);</li>
								<li>выбрать год (выпадающая панель).</li>
							</ol>
						</li>
						<li>При появлении нового события в боковом меню напротив раздела «События» должна появляться точка. При нажатии на раздел «События» и просмотре новых событий подсветка (точка) пропадает.</li>
						<li>Если у пользователя установлена финансовая блокировка, не должны отображаться события камер.</li>
						<li>Если камера в промопериоде, то события по такой камере продолжают приходить до тех пор, пока не закончится промопериод. После выхода камеры из промопериода проводится проверка, находится ли аккаунт в финансовой блокировке. Если аккаунт в финансовой блокировке, отправка событий по камере приостанавливается.</li>
					</ol>
					<p>Карточка события формируется из данных, возвращённых в ответе на запрос <a href="/pages/portofolio/api/postevents.html">POST api/v3/events</a>:</p>
					<ul>
						<li>Наименование события - поле message;</li>
						<li>Иконка события - хранится локально на фронте и подставляется на основании поля icon (метод POST api/v3/events, параметр events.icon);</li>
						<li>Дата события - Время события - указывается на основании поля update_at;</li>
						<li>Ссылка на устройство (если есть устройство, вид ссылки <b>/devices/{origin_id}</b>):
							<ol>
								<li>origin_type = Device::Camera;</li>
								<li>origin_type = Device::Zwave;</li>
							</ol>
						</li>
						<li>Если origin_type = Device::Camera:
							<ol>
								<li>ЛК УД: В рамках первого этапа меняем скриншот на «шеврон» (иконка [>]) в адаптиве, т.к. пока не умеем переходить к конкретному событию;</li>
								<li>МП УД: справа должен быть скриншот события;</li>
							</ol>
						</li>
						<li>Если <b>origin_type = Device</b> справа должна быть иконка «шеврон».</li>
					</ul>
				</div>

				<!------------------------------------------------------------------------------------>
				<!--	Нефункциональные требования													-->
				<!------------------------------------------------------------------------------------>
				<h1 id="section-8">Нефункциональные требования</h1>
				<div>
					<!-------------------------------------------------------------------------------->
					<!--	Требования к интерфейсу пользователя									-->
					<!-------------------------------------------------------------------------------->
					<h2 id="section-9">Требования к интерфейсу пользователя</h2>
					<div>
						<!-- Таблица Элементы интерфейса страницы «События» (ЛК УД) -->
						<table class="confluence-table">
							<caption>Таблица 1 — Элементы интерфейса страницы «События» (ЛК УД)</caption>
							<thead>
								<tr>
									<th colspan="3">Элемент интерфейса</th>
									<th>Описание</th>
									<th>Данные</th>
									<th>Валидация</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>Дата</td>
									<td></td>
									<td></td>
									<td>Отображается в виде текста формата <b>День недели дд.мм.гггг</b></td>
									<td>Метод POST api/v3/events, параметр <b>date_from</b></td>
									<td></td>
								</tr>
								<tr>
									<td>Список событий</td>
									<td></td>
									<td></td>
									<td>Список карточек событий, подходящих под установленные фильтры</td>
									<td>Метод POST api/v3/events</td>
									<td></td>
								</tr>
								<tr>
									<td></td>
									<td>Карточка события</td>
									<td></td>
									<td>Блок с информацией о событии</td>
									<td></td>
									<td></td>
								</tr>
								<tr>
									<td></td>
									<td></td>
									<td>Иконка события</td>
									<td>В зависимости от типа события отображается</td>
									<td>Метод POST api/v3/events, параметр events.icon</td>
									<td></td>
								</tr>
								<tr>
									<td></td>
									<td></td>
									<td>Текст события</td>
									<td></td>
									<td>Метод POST api/v3/events, параметр events.message</td>
									<td></td>
								</tr>
								<tr>
									<td></td>
									<td></td>
									<td>Дата события</td>
									<td>Дата и время события</td>
									<td>Метод POST api/v3/events, параметр events.extra.begin</td>
									<td></td>
								</tr>
								<tr>
									<td></td>
									<td></td>
									<td>Название устройства</td>
									<td></td>
									<td>Метод POST api/v3/events, параметр events.origin_id</td>
									<td>Метод POST api/v3/events events.origin_type = Device::Camera и events.origin_type = Device</td>
								</tr>
								<tr>
									<td></td>
									<td></td>
									<td>Ссылка на устройство</td>
									<td>По нажатии на событие открывается страница устройства</td>
									<td>Метод POST api/v3/events, параметр events.origin_id</td>
									<td>Метод POST api/v3/events events.origin_type = Device::Camera и events.origin_type = Device</td>
								</tr>
								<tr>
									<td>Фильтры по событиям</td>
									<td></td>
									<td></td>
									<td>Фильтры для настройки условий отображения событий. Подробное описание здесь: Настройка фильтров событий</td>
									<td></td>
									<td></td>
								</tr>
							</tbody>
						</table>

						<!-- Таблица Элементы интерфейса экрана «События» (МП УД) -->
						<table class="confluence-table">
							<caption>Таблица 2 — Элементы интерфейса экрана «События» (МП УД)</caption>
							<thead>
								<tr>
									<th colspan="3">Элемент интерфейса</th>
									<th>Описание</th>
									<th>Данные</th>
									<th>Валидация</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>Кнопка Колокольчик</td>
									<td></td>
									<td></td>
									<td>По кнопке открывается экран «Уведомления»</td>
									<td>Метод GET /api/v2/notifications</td>
									<td></td>
								</tr>
								<tr>
									<td>Фильтры по событиям</td>
									<td></td>
									<td></td>
									<td>Фильтры для настройки условий отображения событий. Подробное описание здесь: Настройка фильтров событий</td>
									<td></td>
									<td></td>
								</tr>
								<tr>
									<td>Список событий</td>
									<td></td>
									<td></td>
									<td>Список карточек событий, подходящих под установленные фильтры</td>
									<td>Метод POST api/v3/events</td>
									<td></td>
								</tr>
								<tr>
									<td></td>
									<td>Карточка события</td>
									<td></td>
									<td>Блок с информацией о событии</td>
									<td></td>
									<td></td>
								</tr>
								<tr>
									<td></td>
									<td></td>
									<td>Иконка события</td>
									<td>В зависимости от типа события отображается</td>
									<td>Метод POST api/v3/events, параметр events.icon</td>
									<td></td>
								</tr>
								<tr>
									<td></td>
									<td></td>
									<td>Текст события</td>
									<td></td>
									<td>Метод POST api/v3/events, параметр events.message</td>
									<td></td>
								</tr>
								<tr>
									<td></td>
									<td></td>
									<td>Дата события</td>
									<td>Дата и время события</td>
									<td>Метод POST api/v3/events, параметр events.extra.begin</td>
									<td></td>
								</tr>
								<tr>
									<td></td>
									<td></td>
									<td>Название устройства</td>
									<td></td>
									<td>Метод POST api/v3/events, параметр events.origin_id</td>
									<td>Метод POST api/v3/events events.origin_type = Device::Camera и events.origin_type = Device</td>
								</tr>
								<tr>
									<td></td>
									<td></td>
									<td>Ссылка на устройство</td>
									<td>По нажатии на событие открывается страница устройства. По нажатии на событие камеры открывается это событие в плеере камеры</td>
									<td>Метод POST api/v3/events, параметр events.origin_id</td>
									<td>Метод POST api/v3/events events.origin_type = Device::Camera и events.origin_type = Device</td>
								</tr>
								<tr>
									<td></td>
									<td></td>
									<td>Превью камеры</td>
									<td>Отображается в карточке события камеры справа от основной информации о событии</td>
									<td></td>
									<td>Метод POST api/v3/events events.origin_type = Device::Camera</td>
								</tr>
								<tr>
									<td>Фильтры по событиям</td>
									<td></td>
									<td></td>
									<td>Фильтры для настройки условий отображения событий. Подробное описание здесь: Настройка фильтров событий</td>
									<td></td>
									<td></td>
								</tr>
							</tbody>
						</table>
					</div>

					<!-------------------------------------------------------------------------------->
					<!--	Макеты																	-->
					<!-------------------------------------------------------------------------------->
					<h2 id="section-10">Макеты</h2>
					<div>
						<p><a href="https://www.figma.com/design/HRrRCYSTtqxPSmAgnBUrPf/%D0%90%D0%BD%D0%B4%D1%80%D0%B5%D0%B9-%D0%93%D0%BE%D0%B2%D0%BE%D1%80%D0%BE%D0%B2-s-team-library?node-id=2311-27413&t=1kX1Y1xjDreJpCJp-4" target="_blank">Макеты ЛК УД (Web)</a>.</p>
						<p><a href="https://www.figma.com/design/HRrRCYSTtqxPSmAgnBUrPf/%D0%90%D0%BD%D0%B4%D1%80%D0%B5%D0%B9-%D0%93%D0%BE%D0%B2%D0%BE%D1%80%D0%BE%D0%B2-s-team-library?node-id=2311-150674&t=1kX1Y1xjDreJpCJp-4" target="_blank">Макеты МП УД (Android)</a>.</p>
						<p><a href="https://www.figma.com/design/HRrRCYSTtqxPSmAgnBUrPf/%D0%90%D0%BD%D0%B4%D1%80%D0%B5%D0%B9-%D0%93%D0%BE%D0%B2%D0%BE%D1%80%D0%BE%D0%B2-s-team-library?node-id=2311-159524&t=1kX1Y1xjDreJpCJp-4" target="_blank">Макеты МП УД (iOS)</a>.</p>
					</div>

					<!-------------------------------------------------------------------------------->
					<!--	Требования к разграничению доступа										-->
					<!-------------------------------------------------------------------------------->
					<h2 id="section-11">Требования к разграничению доступа</h2>
					<div>
						<table class="confluence-table">
							<caption>Матрица доступа</caption>
							<thead>
								<tr>
									<th rowspan="2">Функция</th>
									<th colspan="3">Владелец УД (owner)</th>
									<th colspan="3">Пользователь с правами полного управления (adult)</th>
									<th colspan="3">Пользователь с правами ограниченного управления (child)</th>
									<th colspan="3">Пользователь с правами демо-режима (demo)</th>
								</tr>
								<tr>
									<th>Web</th>
									<th>iOS</th>
									<th>Android</th>
									<th>Web</th>
									<th>iOS</th>
									<th>Android</th>
									<th>Web</th>
									<th>iOS</th>
									<th>Android</th>
									<th>Web</th>
									<th>iOS</th>
									<th>Android</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>Просмотр событий</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Функциональность отсутствует</td>
									<td>Нет доступа</td>
									<td>Нет доступа</td>
								</tr>
								<tr>
									<td>Управление фильтрами</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Функциональность отсутствует</td>
									<td>Нет доступа</td>
									<td>Нет доступа</td>
								</tr>
								<tr>
									<td>Переход к устройству</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Есть доступ</td>
									<td>Функциональность отсутствует</td>
									<td>Нет доступа</td>
									<td>Нет доступа</td>
								</tr>
							</tbody>
						</table>
					</div>

					<!-------------------------------------------------------------------------------->
					<!--	Требования к метрикам для аналитики продукта							-->
					<!-------------------------------------------------------------------------------->
					<h2 id="section-12">Требования к метрикам для аналитики продукта</h2>
					<div>
						<!---------------------------------------------------------------------------->
						<!--	Метрики web															-->
						<!---------------------------------------------------------------------------->
						<h3 id="section-13">Метрики web</h3>
						<div>
							<table class="confluence-table">
								<caption>Метрики web</caption>
								<thead>
									<tr>
										<th>Триггер</th>
										<th>Название web</th>
										<th>Доп.параметры</th>
										<th>Значения доп.параметров</th>
										<th>Что меряем</th>
										<th>Скриншот/ доп. описание</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td>Клик по пункту меню</td>
										<td>menu_item</td>
										<td>[<i>menu_item</i>]</td>
										<td>
											<ul>menu_item:
												<li>dashboard</li>
												<li>devices</li>
												<li><b>events</b></li>
												<li>rules</li>
												<li>subscriptions</li>
												<li>balance</li>
												<li>settings</li>
												<li>help</li>
											</ul>
										</td>
										<td>Кол-во нажатий на пункт меню (добавляем "События")</td>
										<td>Измеряет удобство меню</td>
									</tr>
									<tr>
										<td>Открытие страницы событий</td>
										<td>events_opened</td>
										<td></td>
										<td></td>
										<td>Кол-во открытий раздела "События"</td>
										<td>Измеряет востребованность раздела</td>
									</tr>
									<tr>
										<td>Клик по фильтру</td>
										<td>events_filter_click</td>
										<td>[<i>filter_type</i>]</td>
										<td>
											<ul>filter_type:
												<li>event_data</li>
												<li>event_time</li>
												<li>event_groups</li>
												<li>event_types</li>
												<li>devices</li>
											</ul>
										</td>
										<td>Кол-во использований фильтров</td>
										<td>Показывает востребованность фильтров</td>
									</tr>
									<tr>
										<td>Применение фильтров</td>
										<td>events_filters-apply_click</td>
										<td>[<i>filters_count</i>]-[<i>filters_list</i>]</td>
										<td>3, [event_groups, event_types, devices]</td>
										<td>Кол-во завершений настроек фильтров</td>
										<td>Помогает анализировать сегментацию аудитории</td>
									</tr>
									<tr>
										<td>Очистка фильтров</td>
										<td>events_filters-clear_click</td>
										<td></td>
										<td></td>
										<td>Кол-во сбросов настроек фильтрации</td>
										<td>Показывает частоту сброса настроек</td>
									</tr>
									<tr>
										<td>Сброс фильтра</td>
										<td>events_filter-reset_click</td>
										<td>[<i>filter_type</i>]</td>
										<td>
											<ul>filter_type:
												<li>event_data</li>
												<li>event_time</li>
												<li>event_groups</li>
												<li>event_types</li>
												<li>devices</li>
											</ul>
										</td>
										<td>Кол-во возвратов фильтра к исходным настройкам</td>
										<td>Помогает оценить удобство работы с интерфейсом</td>
									</tr>
									<tr>
										<td>Клик по событию</td>
										<td>events_event-element_click</td>
										<td>[<i>event_type</i>]</td>
										<td><a href="/pages/portofolio/database/event_types.html">event_types</a></td>
										<td>Кол-во кликов по событиям</td>
										<td>Помогает определить востребованные события</td>
									</tr>
									<tr>
										<td>Успешный запрос фильтров API</td>
										<td>events_get-filters_api-success</td>
										<td>[<i>response_time</i>]</td>
										<td>150ms, 200ms, 300ms</td>
										<td>Кол-во успешных загрузок фильтров</td>
										<td>Мониторинг производительности API</td>
									</tr>
									<tr>
										<td>Ошибка запроса фильтров API</td>
										<td>events_get-filters_api-failed</td>
										<td>[<i>error_code</i>]-[<i>error_message</i>]</td>
										<td>404-Not Found, 404703-Недоступен список фильтров</td>
										<td>Проблемы с загрузкой фильтров</td>
										<td>Выявление проблем API</td>
									</tr>
									<tr>
										<td>Успешный запрос событий API</td>
										<td>events_post-events_api-success</td>
										<td>events_count</td>
										<td>20</td>
										<td>Кол-во успешных запросов событий API</td>
										<td>Мониторинг производительности API</td>
									</tr>
									<tr>
										<td>Ошибка запроса событий API</td>
										<td>events_post-events_api-failed</td>
										<td>[<i>error_code</i>]-[<i>error_message</i>]</td>
										<td>404-Not Found</td>
										<td>Проблемы с загрузкой событий API</td>
										<td>Выявление проблем API</td>
									</tr>
								</tbody>
							</table>
						</div>

						<!---------------------------------------------------------------------------->
						<!--	Метрики mobile														-->
						<!---------------------------------------------------------------------------->
						<h3 id="section-14">Метрики mobile</h3>
						<div>
							<table class="confluence-table">
								<caption>Экраны firebase</caption>
								<thead>
									<tr>
										<th>№ <br>п/п</th>
										<th>Название экрана</th>
										<th>Firebase</th>
										<th>Комментарий</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td><b>1</b></td>
										<td>Экран "События и уведомления"</td>
										<td>screen_events_open</td>
										<td></td>
									</tr>
								</tbody>
							</table>
							<table class="confluence-table">
								<caption>События firebase</caption>
								<thead>
									<tr>
										<th>Название события</th>
										<th>Название метрики</th>
										<th>Доп. параметры</th>
										<th>Значения доп.параметров</th>
										<th>Комментарий</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td>Тап по пункту "События" в таб-баре</td>
										<td>action_menu_events_tap</td>
										<td></td>
										<tdclass="param-values"></tdclass=>
										<td>Отслеживание навигации пользователя. Помогает определить востребованность раздела.</td>
									</tr>
									<tr>
										<td>Тап по фильтру событий</td>
										<td>action_events_filter_tap</td>
										<td>[<i>filter_type</i>]</td>
										<td>
											<ul>filter_type:
												<li>event_data</li>
												<li>event_time</li>
												<li>event_groups</li>
												<li>event_types</li>
												<li>devices</li>
											</ul>
										</td>
										<td>Измерение взаимодействия с фильтрами. Показывает, какие параметры фильтрации наиболее востребованы.</td>
									</tr>
									<tr>
										<td>Применение фильтра</td>
										<td>action_events_filter-apply_tap</td>
										<td>[<i>filter_type</i>]-[<i>filter_value</i>]</td>
										<td>devices-camera, devices-controller</td>
										<td>Фиксация момента применения фильтров. Анализ среднего количества используемых фильтров. При фильтрации по конкретному устройству, записывать только тип устройства без uuid. При фильтрации по дате и времени, записывать только тип фильтра.</td>
									</tr>
									<tr>
										<td>Очистка фильтра</td>
										<td>action_events_filter-clear_tap</td>
										<td>[<i>filter_type</i>]</td>
										<td></td>
										<td>Отслеживание сброса отдельных фильтров. Помогает понять, какие фильтры пользователи чаще сбрасывают.</td>
									</tr>
									<tr>
										<td>Сброс всех фильтров</td>
										<td>action_events_filters-clear_tap</td>
										<td></td>
										<td></td>
										<td>Фиксация полного сброса фильтров. Показывает частоту возврата к исходным настройкам.</td>
									</tr>
									<tr>
										<td>Тап по событию в списке</td>
										<td>action_event-element_tap</td>
										<td>[<i>event_type</i>]</td>
										<td>event_types</td>
										<td>Помогает определить востребованные события.</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>

				<!------------------------------------------------------------------------------------>
				<!--	Приложения																	-->
				<!------------------------------------------------------------------------------------>
				<h1 id="section-15">Приложения</h1>
				<div>
					<!-------------------------------------------------------------------------------->
					<!--	Описание БД																-->
					<!-------------------------------------------------------------------------------->
					<h2 id="section-16">Описание БД</h2>
					<div>
						<p>Сущности БД УД (smart-back), используемые в сценариях:</p>
						<ul>
							<li><a href="/pages/portofolio/database/events_groups.html">events_groups</a> - Группы событий. Сущность для создания групп событий и дальнейшего использования этих групп в фильтрации в разделе события;</li>
							<li><a href="/pages/portofolio/database/event_types.html">event_types</a> - Справочник событий с параметрами событий для использования в разделе УД "События" при отображении записи и для фильтрации событий;</li>
							<li><a href="/pages/portofolio/database/event_types_groups.html">event_types_groups</a> - JOIN-таблица.</li>
						</ul>
					</div>

					<!-------------------------------------------------------------------------------->
					<!--	Описание API															-->
					<!-------------------------------------------------------------------------------->
					<h2 id="section-17">Описание API</h2>
					<div>
						<p>Методы Бэкенда УД (smart-back), используемые в сценариях:</p>
						<ul>
							<li><a href="/pages/portofolio/api/getfilters.html">GET api/v3/events/filters</a> - метод запроса фильтров и их типов;</li>
							<li><a href="/pages/portofolio/api/postevents.html">POST api/v3/events</a> - метод запроса событий;</li>
							<li><a href="/pages/portofolio/api/postdays.html">POST api/v3/events/days</a> - метод запроса дат с событиями.</li>
						</ul>
						<p>Методы EStore, используемые в сценариях:</p>
						<ul>
							<li>POST /api/estore/events/by_devices.</li>
						</ul>
					</div>

					<!-------------------------------------------------------------------------------->
					<!--	Скрипты																	-->
					<!-------------------------------------------------------------------------------->
					<h2 id="section-18">Скрипты</h2>
					<div class="scripts-container">
						<!-- Скрипт наполнения таблицы БД "Группы событий" -->
						<div class="script-section">
							<h3 id="section-19">Скрипт наполнения таблицы БД "Группы событий" (event_groups)</h3>
							<div class="script-content">
								<ol class="styled-list">
									<li>
										<span class="script-field">"id":</span> 
										<span class="script-value auto">auto</span>, 
										<span class="script-field">"name":</span> 
										<span class="script-value string">"Учётная запись"</span>
									</li>
									<li>
										<span class="script-field">"id":</span> 
										<span class="script-value auto">auto</span>, 
										<span class="script-field">"name":</span> 
										<span class="script-value string">"Устройства"</span>
									</li>
									<li>
										<span class="script-field">"id":</span> 
										<span class="script-value auto">auto</span>, 
										<span class="script-field">"name":</span> 
										<span class="script-value string">"Камеры"</span>
									</li>
									<li>
										<span class="script-field">"id":</span> 
										<span class="script-value auto">auto</span>, 
										<span class="script-field">"name":</span> 
										<span class="script-value string">"Мой дом"</span>
									</li>
									<li>
										<span class="script-field">"id":</span> 
										<span class="script-value auto">auto</span>, 
										<span class="script-field">"name":</span> 
										<span class="script-value string">"Мои сценарии"</span>
									</li>
									<li>
										<span class="script-field">"id":</span> 
										<span class="script-value auto">auto</span>, 
										<span class="script-field">"name":</span> 
										<span class="script-value string">"Баланс и услуги"</span>
									</li>
								</ol>
							</div>
						</div>

						<!-- Скрипт наполнения таблицы БД "Типы событий" -->
						<div class="script-section">
							<h3 id="section-20">Скрипт наполнения таблицы БД "Типы событий" (event_types)</h3>
							<div class="script-content">
								<ol class="styled-list multi-level">
									<li>
										<span class="script-field">"id":</span> 
										<span class="script-value auto">auto</span>
									</li>
									<li>
										<span class="script-field">"event_name":</span> 
										<span class="script-value string">"register_event"</span> 
										<span class="script-comment">из definitions.rb</span>
									</li>
									<li>
										<span class="script-field">"filter_name":</span>
										<ol class="nested-list">
											<li>
												<span class="script-value object">{"filter_name": "Человек в кадре"}</span>
												<span class="script-comment">для события с "eid": 20104</span>
											</li>
											<li>
												<span class="script-value object">{"filter_name": "Обнаружение лиц"}</span>
												<span class="script-comment">для события с "eid": 20102</span>
											</li>
											<li>
												<span class="script-value object">{"filter_name": "Движение"}</span>
												<span class="script-comment">для события с "eid": 20002</span>
											</li>
											<li>
												<span class="script-value object">{"filter_name": "Звук"}</span>
												<span class="script-comment">для события с "eid": 20007</span>
											</li>
											<li>
												<span class="script-value object">{"filter_name": "Пересечение линии"}</span>
												<span class="script-comment">для события с "eid": 20004</span>
											</li>
											<li>
												<span class="script-value object">{"filter_name": "Перекрытие обзора"}</span>
												<span class="script-comment">для события с "eid": 20003</span>
											</li>
											<li>
												<span class="script-value object">{"filter_name": "Камера онлайн"}</span>
												<span class="script-comment">для события с "eid": 32000</span>
											</li>
											<li>
												<span class="script-value object">{"filter_name": "Камера офлайн"}</span>
												<span class="script-comment">для события с "eid": 32001</span>
											</li>
											<li>
												<span class="script-value object">{"filter_name": "Обрыв трансляции"}</span>
												<span class="script-comment">для события с "eid": 60000</span>
											</li>
										</ol>
									</li>
									<li>
										<span class="script-field">"origin_class":</span> 
										<span class="script-value string">"origin_class"</span> 
										<span class="script-comment">из definitions.rb</span>
									</li>
									<li>
										<span class="script-field">"eid":</span> 
										<span class="script-value string">"eid"</span> 
										<span class="script-comment">из definitions.rb</span>
									</li>
									<li>
										<span class="script-field">"icon_name":</span> 
										<span class="script-value string">"icon"</span> 
										<span class="script-comment">из definitions.rb</span>
									</li>
									<li>
										<span class="script-field">"default_message":</span> 
										<span class="script-value string">"default"</span> 
										<span class="script-comment">из events.yml для event_type = event_name</span>
									</li>
									<li>
										<span class="script-field">"popup":</span> 
										<span class="script-value string">"popup"</span> 
										<span class="script-comment">из definitions.rb</span>
									</li>
								</ol>
							</div>
						</div>

						<!-- Скрипт наполнения join-таблицы -->
						<div class="script-section">
							<h3 id="section-21">Скрипт наполнения join-таблицы (event_types_groups)</h3>
							<div class="script-content">
								<ol class="styled-list complex-list">
									<li>
										<span class="script-field">"id" группы</span> 
										<span class="script-value string">"Учётная запись"</span> 
										<span class="script-comment">из event_groups</span>
										<span class="script-operator">|</span>
										<span class="script-field">"id" типа события</span> 
										<span class="script-value string">из event_types</span>
										<span class="script-comment">для которых "origin_class" = Account + User</span>
									</li>
									<li>
										<span class="script-field">"id" группы</span> 
										<span class="script-value string">"Устройства"</span> 
										<span class="script-comment">из event_groups</span>
										<span class="script-operator">|</span>
										<span class="script-field">"id" типа события</span> 
										<span class="script-value string">из event_types</span>
										<span class="script-comment">для которых "origin_class" = Device + Node</span>
									</li>
									<li>
										<span class="script-field">"id" группы</span> 
										<span class="script-value string">"Камеры"</span> 
										<span class="script-comment">из event_groups</span>
										<span class="script-operator">|</span>
										<span class="script-field">"id" типа события</span> 
										<span class="script-value string">из event_types</span>
										<span class="script-comment">для которых "origin_class" = Device:Camera</span>
									</li>
									<li>
										<span class="script-field">"id" группы</span> 
										<span class="script-value string">"Мой дом"</span> 
										<span class="script-comment">из event_groups</span>
										<span class="script-operator">|</span>
										<span class="script-field">"id" типа события</span> 
										<span class="script-value string">из event_types</span>
										<span class="script-comment">для которых "origin_class" = Home + Home:Mode + Room</span>
									</li>
									<li>
										<span class="script-field">"id" группы</span> 
										<span class="script-value string">"Мои сценарии"</span> 
										<span class="script-comment">из event_groups</span>
										<span class="script-operator">|</span>
										<span class="script-field">"id" типа события</span> 
										<span class="script-value string">из event_types</span>
										<span class="script-comment">для которых "origin_class" = Rule</span>
									</li>
									<li>
										<span class="script-field">"id" группы</span> 
										<span class="script-value string">"Баланс и услуги"</span> 
										<span class="script-comment">из event_groups</span>
										<span class="script-operator">|</span>
										<span class="script-field">"id" типа события</span> 
										<span class="script-value string">из event_types</span>
										<span class="script-comment">для которых "origin_class" = TariffOption</span>
									</li>
								</ol>
							</div>
						</div>
					</div>
				</div>
			</article>
		</main>
	</div>
	
	<!-- Кнопка "Вверх" -->
	<button class="scroll-to-top" id="scrollToTop" aria-label="Вернуться к началу страницы"></button>
	
	<script src="/assets/scripts/load-sidebar.js"></script>
	<script src="/assets/scripts/prism.js"></script>
	<script src="/assets/scripts/script.js"></script>

	<script>
	// Обработка ссылок с data-path в основном контенте
	document.addEventListener('DOMContentLoaded', function() {
		const contentLinks = document.querySelectorAll('#content a[data-path]');
		contentLinks.forEach(link => {
			const relativePath = link.getAttribute('data-path');
			if (typeof getAbsolutePath === 'function') {
				link.href = getAbsolutePath(relativePath);
			} else {
				// Fallback - используем абсолютный путь от корня
				link.href = '/' + relativePath;
			}
		});
	});
	</script>
</body>
</html>